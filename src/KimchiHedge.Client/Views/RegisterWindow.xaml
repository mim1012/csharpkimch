<Window x:Class="KimchiHedge.Client.Views.RegisterWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="KimchiHedge - 회원가입"
        Height="620" Width="400"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        Background="{StaticResource BackgroundDarkestBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 메인 회원가입 영역 -->
        <Border Grid.Row="0"
                Background="{StaticResource BackgroundDarkBrush}"
                Margin="32,24"
                Padding="32"
                CornerRadius="4"
                BorderBrush="{StaticResource BorderDefaultBrush}"
                BorderThickness="1">
            <StackPanel VerticalAlignment="Center">
                <!-- 로고 -->
                <TextBlock Text="KimchiHedge"
                           Style="{StaticResource TextBlockHeader}"
                           Foreground="{StaticResource AccentBlueBrush}"
                           HorizontalAlignment="Center"
                           FontSize="{StaticResource FontSize2XL}"/>
                <TextBlock Text="회원가입"
                           Style="{StaticResource TextBlockMuted}"
                           HorizontalAlignment="Center"
                           Margin="0,8,0,24"/>

                <!-- 가입 완료 메시지 -->
                <Border Background="#1A22C55E"
                        BorderBrush="#22C55E"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="16"
                        Margin="0,0,0,16"
                        Visibility="{Binding IsRegistrationComplete, Converter={StaticResource BoolToVisibilityConverter}}">
                    <StackPanel>
                        <TextBlock Text="{Binding SuccessMessage}"
                                   Foreground="#22C55E"
                                   TextWrapping="Wrap"
                                   FontSize="{StaticResource FontSizeSM}"/>
                        <Button Content="로그인하기"
                                Style="{StaticResource ButtonPrimary}"
                                Height="36"
                                Margin="0,12,0,0"
                                Command="{Binding GoToLoginCommand}"/>
                    </StackPanel>
                </Border>

                <!-- 입력 폼 (가입 완료 전에만 표시) -->
                <StackPanel Visibility="{Binding IsRegistrationComplete, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                    <!-- 이메일 입력 -->
                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Text="이메일"
                                   Style="{StaticResource TextBlockLabel}"
                                   Margin="0,0,0,8"/>
                        <TextBox x:Name="EmailTextBox"
                                 Style="{StaticResource TextBoxLine}"
                                 Text="{Binding Email, UpdateSourceTrigger=PropertyChanged}"
                                 IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBoolConverter}}"
                                 Height="36"/>
                    </StackPanel>

                    <!-- 비밀번호 입력 -->
                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Text="비밀번호 (8자 이상)"
                                   Style="{StaticResource TextBlockLabel}"
                                   Margin="0,0,0,8"/>
                        <PasswordBox x:Name="PasswordBox"
                                     Style="{StaticResource PasswordBoxLine}"
                                     IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBoolConverter}}"
                                     Height="36"/>
                    </StackPanel>

                    <!-- 비밀번호 확인 -->
                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Text="비밀번호 확인"
                                   Style="{StaticResource TextBlockLabel}"
                                   Margin="0,0,0,8"/>
                        <PasswordBox x:Name="PasswordConfirmBox"
                                     Style="{StaticResource PasswordBoxLine}"
                                     IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBoolConverter}}"
                                     Height="36"/>
                    </StackPanel>

                    <!-- 추천인 UID -->
                    <StackPanel Margin="0,0,0,20">
                        <TextBlock Text="추천인 UID (선택)"
                                   Style="{StaticResource TextBlockLabel}"
                                   Margin="0,0,0,8"/>
                        <TextBox Style="{StaticResource TextBoxLine}"
                                 Text="{Binding ReferralUid, UpdateSourceTrigger=PropertyChanged}"
                                 IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBoolConverter}}"
                                 Height="36"/>
                    </StackPanel>

                    <!-- 에러 메시지 -->
                    <TextBlock Text="{Binding ErrorMessage}"
                               Foreground="{StaticResource StatusLossBrush}"
                               FontSize="{StaticResource FontSizeSM}"
                               TextWrapping="Wrap"
                               Visibility="{Binding ErrorMessage, Converter={StaticResource StringToVisibilityConverter}}"
                               Margin="0,0,0,16"/>

                    <!-- 가입 신청 버튼 -->
                    <Button Content="가입 신청"
                            Style="{StaticResource ButtonPrimary}"
                            Height="44"
                            Command="{Binding RegisterCommand}"
                            IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBoolConverter}}"/>

                    <!-- 로딩 표시 -->
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Center"
                                Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}"
                                Margin="0,16,0,0">
                        <TextBlock Text="처리 중..."
                                   Style="{StaticResource TextBlockMuted}"/>
                    </StackPanel>

                    <!-- 로그인 링크 -->
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Center"
                                Margin="0,20,0,0">
                        <TextBlock Text="이미 계정이 있으신가요? "
                                   Style="{StaticResource TextBlockMuted}"/>
                        <TextBlock>
                            <Hyperlink Command="{Binding GoToLoginCommand}"
                                       Foreground="{StaticResource AccentBlueBrush}">
                                로그인
                            </Hyperlink>
                        </TextBlock>
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- 하단 정보 -->
        <StackPanel Grid.Row="1"
                    HorizontalAlignment="Center"
                    Margin="0,0,0,16">
            <TextBlock Text="v1.0.0"
                       Style="{StaticResource TextBlockMuted}"
                       HorizontalAlignment="Center"/>
        </StackPanel>
    </Grid>
</Window>
