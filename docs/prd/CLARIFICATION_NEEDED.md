# 기획안 명확화 - 최종 확정

> **문서 버전:** v2.0
> **작성일:** 2025-12-09
> **상태:** ✅ 모든 주요 사항 확정

---

## ✅ 확정된 사항 요약

| 항목 | 결정 |
|------|------|
| UI 프레임워크 | **WPF** (XAML, MVVM 패턴) |
| 포지션 처리 | **단일 포지션만** (기존 포지션 있으면 신규 진입 차단) |
| 해외 거래소 | **BingX** 우선, 추후 확장 가능 구조 |
| 김프 서버 | **함께 개발** (인증 서버 + 김프 서버) |
| 인증 방식 | **서버 기반 인증** (JWT 토큰, HWID 매칭) |
| 보안 | **AES-256 암호화**, HTTPS only |

---

## 1. 아키텍처 확정

### 1.1 서버 구현 범위 - ✅ 확정
**결정:** 인증 서버 + 김프 서버 **함께 개발**

**개발 범위:**
- 인증 서버 (Auth Server)
  - 사용자 인증/라이센스 관리
  - 관리자 페이지
- 김프 서버 (Kimchi Premium Server)
  - 업비트/BingX 시세 수집
  - 실시간 김프 계산
  - 클라이언트에 데이터 전송

### 1.2 서버-클라이언트 통신 방식
**결정:** WebSocket (실시간 양방향, 1초 단위 김프 데이터)

---

## 2. UI/UX 확정

### 2.1 UI 프레임워크 - ✅ 확정
**결정:** **WPF (Windows Presentation Foundation)**

**선택 이유:**
- XAML 기반 현대적 UI
- MVVM 패턴으로 깔끔한 아키텍처
- 데이터 바인딩 강력 지원
- 실시간 데이터 표시에 적합

### 2.2 UI 디자인 (기본값)
- 다크 모드 기본
- 실시간 김프 표시
- 트레이 아이콘 지원

---

## 3. 거래 로직 확정

### 3.1 포지션 처리 - ✅ 확정
**결정:** **단일 포지션만 허용**

**동작 방식:**
- 기존 포지션이 있으면 신규 진입 차단
- 익절/손절 완료 후에만 새 포지션 진입 가능
- 물타기/추가 매수 불가

### 3.2 체결 수량 불일치 허용 범위 (기본값)
- 허용 오차: 0.0001 BTC 이하
- 최대 재시도: 3회
- 실패 시: 롤백 (업비트 매도)

### 3.3 쿨다운 시간 (기본값)
- 단위: 초
- 기본값: 60초
- 범위: 10초 ~ 3600초

---

## 4. 거래소 확정

### 4.1 지원 거래소 - ✅ 확정
**결정:** **BingX 우선, 추후 확장 가능 구조**

| 구분 | 거래소 | 마켓 | 상태 |
|------|--------|------|------|
| 현물 | 업비트 | BTC/KRW | ✅ 지원 |
| 선물 | BingX | BTCUSDT Perpetual | ✅ 우선 지원 |
| 선물 | Bybit | BTCUSDT Perpetual | 🔜 추후 확장 |

**확장 가능 구조:**
- 거래소 인터페이스(IExchange) 설계
- 새 거래소 추가 시 구현체만 추가
- 사용자가 거래소 선택 가능

---

## 5. 인증/보안 확정

### 5.1 인증 서버 - ✅ 확정
**결정:** 인증 서버 기반 구조

**기능:**
- 이메일/비밀번호 로그인
- JWT 토큰 발급
- 라이센스 상태 관리 (Active, Expired, Suspended)
- HWID 1:1 매칭
- 관리자 페이지

### 5.2 보안 요구사항 - ✅ 확정
- API Key: AES-256 암호화
- 통신: HTTPS only (HTTP 차단)
- 설정파일: 암호화 저장
- 평문 저장: 금지

---

## 6. 기술 스택 최종

| 구분 | 기술 |
|------|------|
| 클라이언트 언어 | C# (.NET 8) |
| UI 프레임워크 | **WPF** |
| 서버 언어 | C# (ASP.NET Core) 또는 Node.js |
| 실시간 통신 | WebSocket |
| 암호화 | AES-256, bcrypt |
| 데이터베이스 | PostgreSQL / SQLite |

---

## 7. 프로젝트 구조 (예정)

```
KimchiHedge/
├── src/
│   ├── KimchiHedge.Client/           # WPF 클라이언트
│   │   ├── Views/
│   │   ├── ViewModels/
│   │   ├── Models/
│   │   └── Services/
│   ├── KimchiHedge.Core/             # 핵심 비즈니스 로직
│   │   ├── Trading/
│   │   ├── Exchanges/
│   │   └── Security/
│   ├── KimchiHedge.AuthServer/       # 인증 서버
│   └── KimchiHedge.KimchiServer/     # 김프 데이터 서버
├── tests/
├── docs/
└── KimchiHedge.sln
```

---

## ✅ 모든 주요 요구사항 확정 완료

이제 프로젝트 스캐폴딩 및 개발을 시작할 수 있습니다.
